<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2026-02-06">

<title>Full-Phasor Grid Following Voltage Source Converter</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<script src="../../../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap-22946cb634ef6c30ead943afa07a37b9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../../assets/img/Logo_colib.svg" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../index.html"> 
<span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">About</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-about">    
        <li>
    <a class="dropdown-item" href="../../../../../about/index.html">
 <span class="dropdown-text">About Colib</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../about/authorGuidelines.html">
 <span class="dropdown-text">Author Guidelines</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../about/codeConduct.html">
 <span class="dropdown-text">Code of Conduct</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../about/notationAndConventions.html">
 <span class="dropdown-text">Notations and conventions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../about/team.html">
 <span class="dropdown-text">Teams and community</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../about/terms.html">
 <span class="dropdown-text">Terms of Reference</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-models" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Models</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-models">    
        <li>
    <a class="dropdown-item" href="../../../../../models/index.html">
 <span class="dropdown-text">All models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../models/1-SynchronousMachines/index.html">
 <span class="dropdown-text">Synchronous Machines</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../models/2-Loads/index.html">
 <span class="dropdown-text">Loads</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-test-cases" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Test Cases</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-test-cases">    
        <li>
    <a class="dropdown-item" href="../../../../../testCases/index.html">
 <span class="dropdown-text">All test cases</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../testCases/GridFollowing_GridForming_DClink/index.html">
 <span class="dropdown-text">Grid Following - Grid Forming DC link</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../testCases/kundur_two_area_system/index.html">
 <span class="dropdown-text">Kundur two-area system</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-contribute" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Contribute</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-contribute">    
        <li>
    <a class="dropdown-item" href="../../../../../contribute/howTo/index.html">
 <span class="dropdown-text">How to contribute</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../contribute/quartoBasics/index.html">
 <span class="dropdown-text">Quarto Basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../contribute/modelTemplate/index.html">
 <span class="dropdown-text">Model template</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../.././contribute/testCaseTemplate/index.qmd">
 <span class="dropdown-text">Test case template</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../../../contact/index.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/CRESYM/Colib_Quarto.github.io" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../../models/index.html">Models</a></li><li class="breadcrumb-item"><a href="../../../../../models/4- HVDC/index.html">HVDC</a></li><li class="breadcrumb-item"><a href="../../../../../models/4- HVDC/VSC/index.html">Voltage Source Converter (VSC)</a></li><li class="breadcrumb-item"><a href="../../../../../models/4- HVDC/VSC/GridFollowingConverter/index.html">Grid following converter (GFL)</a></li><li class="breadcrumb-item"><a href="../../../../../models/4- HVDC/VSC/GridFollowingConverter/UPC-RMS-GFL-VSC/index.html">Full-Phasor Grid Following Voltage Source Converter</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/1-SynchronousMachines/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Synchronous machines</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/1-SynchronousMachines/Generator/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generator</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Generator/SM1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Synchronous Machine Model (SM1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Generator/GENTPJ/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GENTPF/GENTPJ Synchronous Machine with Saturation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Generator/GENSAL/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GENROU/GENSAL Salient-pole/round-rotor synchronous machine without saturation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Generator/GENQEC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GENQEC Synchronous Machine with Saturation</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Voltage Regulators (AVR) / Exciters (EX)</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/ST9C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ST9C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/IEEX2A/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IEEX2A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/SCRX/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SCRX</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/ST5C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ST5C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/ST6C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ST6C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/IEEEX2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IEEEX2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/AcRotatingExciter/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AcRotatingExciter (submodel)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/DC1C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DC1C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/ST7C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ST7C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/AC6C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AC6C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/ST4C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ST4C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/AC8C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AC8C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/ST1C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ST1C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/BBSEX1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BBSEX1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/AC7C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AC7C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/AC1C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AC1C</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Over/under Excitation Limiters</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/UEL1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">UEL1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/SCL2C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SCL2C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/OEL5C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OEL5C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/OEL3C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OEL3C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/OEL4C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OEL4C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/SCL1C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SCL1C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/UEL2C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">UEL2C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/OEL2C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OEL2C</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/1-SynchronousMachines/Governor/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Governors (GOV)</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/IEEEG1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IEEEG1 / GovSteam 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/TGOV3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TGOV3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/HYGOV/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HYGOV</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/GovCT2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GovCT2 / GGOV2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/TGOV1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TGOV1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/IEEEG2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IEEEG2 / GovSteam 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/GAST/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GAST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/GovHydro4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GovHydro4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/GovSteamEU/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GovSteamEU</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/1-SynchronousMachines/PowerSystemStabilizer/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Power System Stabilizers (PSS)</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/PowerSystemStabilizer/PSS2C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PSS2C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/PowerSystemStabilizer/PSS1A/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PSS1A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/PowerSystemStabilizer/PSS6C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PSS6C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/PowerSystemStabilizer/PSS3C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PSS3C</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/2-Loads/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loads</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/2-Loads/ZIPLoad/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ZIP Load Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/2-Loads/ExpLoad/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exponential Load Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/2-Loads/FDLoad/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frequency Dependent Load Model</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/2-Loads/Motor/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motors</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/2-Loads/Motor/SimpleMotor/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Single-cage induction motor model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/2-Loads/Motor/WECC_Motor/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Induction motor model with rotor flux dynamics</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/3-CompensationAndFACTS/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Compensation and FACTS</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/3-CompensationAndFACTS/STATCOM/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EMT STATCOM (Grid Following mode)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/3-CompensationAndFACTS/StaticCompensator/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Static Compensator model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/3-CompensationAndFACTS/Capacitors/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Capacitors</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/4- HVDC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HVDC</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4- HVDC/LCC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Line Commutated Converters (LCC)</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/4- HVDC/VSC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Voltage Source Converter (VSC)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/4- HVDC/VSC/Point-to-Point-HVDC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Point-to-Point HVDC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4- HVDC/VSC/Point-to-Point-HVDC/RTE-RMS-Average-HVDC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RTE Average phasor voltage source converter HVDC Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4- HVDC/VSC/Point-to-Point-HVDC/UPC-EMT-HVDC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Point-to-Point HVDC EMT VSC</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/4- HVDC/VSC/GridFormingConverter/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grid forming converter (GFM)</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4- HVDC/VSC/GridFormingConverter/UPC-EMT-GFM-VSC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generic EMT Grid Forming Voltage Source Converter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4- HVDC/VSC/GridFormingConverter/EPRI-GFM-Converter/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EPRI Grid Forming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4- HVDC/VSC/GridFormingConverter/UPC-RMS-GFM-VSC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generic Phasor Grid Forming Voltage Source Converter</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/4- HVDC/VSC/GridFollowingConverter/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grid following converter (GFL)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth4 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4- HVDC/VSC/GridFollowingConverter/L2EP-RMS-GFL-VSC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L2EP generic RMS grid following voltage source converter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4- HVDC/VSC/GridFollowingConverter/UPC-EMT-GFL-VSC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">UPC generic EMT Grid Following Voltage Source Converter</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/4- HVDC/VSC/GridFollowingConverter/UPC-RMS-GFL-VSC/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Full-Phasor Grid Following Voltage Source Converter</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth5 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4- HVDC/VSC/GridFollowingConverter/UPC-RMS-GFL-VSC/PhasorIo/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phasor-I0 Grid Following Voltage Source Converter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4- HVDC/VSC/GridFollowingConverter/UPC-RMS-GFL-VSC/PhasorPQ1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phasor-PQ1 Grid Following Voltage Source Converter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4- HVDC/VSC/GridFollowingConverter/UPC-RMS-GFL-VSC/PhasorI1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phasor-I1 Grid Following Voltage Source Converter</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#context" id="toc-context" class="nav-link active" data-scroll-target="#context">Context</a></li>
  <li><a href="#model-use-assumptions-validity-domain-and-limitations" id="toc-model-use-assumptions-validity-domain-and-limitations" class="nav-link" data-scroll-target="#model-use-assumptions-validity-domain-and-limitations">Model use, assumptions, validity domain and limitations</a></li>
  <li><a href="#model-description" id="toc-model-description" class="nav-link" data-scroll-target="#model-description">Model description</a>
  <ul class="collapse">
  <li><a href="#transformation-blocks" id="toc-transformation-blocks" class="nav-link" data-scroll-target="#transformation-blocks">Transformation blocks</a></li>
  <li><a href="#angle-and-frequency-tracking" id="toc-angle-and-frequency-tracking" class="nav-link" data-scroll-target="#angle-and-frequency-tracking">Angle and frequency tracking</a></li>
  <li><a href="#current-control" id="toc-current-control" class="nav-link" data-scroll-target="#current-control">Current control</a></li>
  <li><a href="#active-and-reactive-power-control" id="toc-active-and-reactive-power-control" class="nav-link" data-scroll-target="#active-and-reactive-power-control">Active and reactive power control</a></li>
  <li><a href="#limitations-of-current" id="toc-limitations-of-current" class="nav-link" data-scroll-target="#limitations-of-current">Limitations of current</a></li>
  </ul></li>
  <li><a href="#derived-models" id="toc-derived-models" class="nav-link" data-scroll-target="#derived-models">Derived Models</a></li>
  <li><a href="#open-source-implementations" id="toc-open-source-implementations" class="nav-link" data-scroll-target="#open-source-implementations">Open source implementations</a></li>
  <li><a href="#table-of-references" id="toc-table-of-references" class="nav-link" data-scroll-target="#table-of-references">Table of references</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../../models/index.html">Models</a></li><li class="breadcrumb-item"><a href="../../../../../models/4- HVDC/index.html">HVDC</a></li><li class="breadcrumb-item"><a href="../../../../../models/4- HVDC/VSC/index.html">Voltage Source Converter (VSC)</a></li><li class="breadcrumb-item"><a href="../../../../../models/4- HVDC/VSC/GridFollowingConverter/index.html">Grid following converter (GFL)</a></li><li class="breadcrumb-item"><a href="../../../../../models/4- HVDC/VSC/GridFollowingConverter/UPC-RMS-GFL-VSC/index.html">Full-Phasor Grid Following Voltage Source Converter</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Full-Phasor Grid Following Voltage Source Converter</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Carlos Alegre (eRoots) </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 6, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="context" class="level2">
<h2 class="anchored" data-anchor-id="context">Context</h2>
<p>Voltage Source Converters (VSC) are widely used in power systems for a variety of applications, such as wind and photovoltaic generation, High Voltage Direct Current (HVDC) transmission, and Flexible AC Transmission Systems (FACTS). The model described here is the Full-Phasor model of a grid-following VSC, which is a type of VSC that is synchronized with the grid, using its frequency and phase. This model, obtained from the many works developed at CITCEA-UPC (Centre d’Innovació Tecnològica en Convertidors Estàtics i Accionaments) such as <a href="#1">[1]</a>, <a href="#2">[2]</a> and <a href="#3">[3]</a>, is useful for studying medium to low-frequency phenomena of the VSC and its interaction with the grid.</p>
</section>
<section id="model-use-assumptions-validity-domain-and-limitations" class="level2">
<h2 class="anchored" data-anchor-id="model-use-assumptions-validity-domain-and-limitations">Model use, assumptions, validity domain and limitations</h2>
<p>The model described allows performing phasor studies of the dynamics of a grid-following voltage source converter. It is specially useful in applications where there are slow-transients that want to be studied, such as transient stability studies or interarea oscillations <a href="#1">[1]</a>, allowing for fast simulations with bigger time steps than the EMT without losing precision on these types of phenomena.</p>
<p>The assumptions made are:</p>
<ul>
<li>The DC side of the converter is considered as an ideal DC voltage source <span class="math display">\[E_{DC}\]</span>.</li>
<li>The AC-side of the converter is connected to the grid through an AC filter formed by a resistance <span class="math display">\[R\]</span> and an inductance <span class="math display">\[L\]</span>. It is represented as three current sources with magnitude and angle defined by the control system.</li>
<li>The system is considered to be balanced, and the positive and negative sequence are not considered.</li>
<li>The electrical variables are represented by phasors that rotate at the synchronous frequency of the grid in steady-state or quasi-steady-state.</li>
<li>The complete control structure from the EMT Model, apart from the PLL, is preserved. Further simplifications are made in the models that derive from the Full-Phasor model.</li>
</ul>
<p>The model has its limitations when performing high-frequency domain phenomena (<span class="math display">\[&gt;1\]</span> kHz), as all the fast-dynamics are not considered since it uses algebraic equations instead of the differential equations that are used on the <a href="../EMTGridFollowingVSC/">EMT model</a>. It is not useful either to calculate unbalanced situation as the model is based on the positive sequence.</p>
<p>From this model, some approximations can be made to reduce the complexity of the model and speed up the simulation if the study to be performed does not require to cover some dynamics of the converter. These derived models can be consulted in Section <a href="#derived-models">4</a></p>
</section>
<section id="model-description" class="level2">
<h2 class="anchored" data-anchor-id="model-description">Model description</h2>
<p>The model can be described with the following schematic:</p>
<div style="background-color:rgba(0, 0, 0, 0); text-align:center; vertical-align: middle; padding:4px 0;">
<img src="{{ 'FullPhasor_GF_VSC.svg'}}" alt="phasor GF VSC scheme" style="float: center; margin-right: 10px; width: 650px;">
</div>
<div data-align="center">
<p>Figure 1: Phasor Grid Following VSC scheme <a href="#2">[2]</a></p>
</div>
<p><br></p>
<p>The main blocks of the model are: * The angle and frequency tracking block, which substitutes the PLL of the EMT model. * The Outer Loop, which provides active and reactive power control by setting a current reference from a power reference. * The Inner Loop, or Current Loop, which corrects the converter voltage to provide the reference current. * The transformation blocks, which transform the electrical variables from <em>abc</em> into <em>qd0</em> and viceversa.</p>
<p>A detailed explanation of each block is provided in the following subsections.</p>
<section id="transformation-blocks" class="level3">
<h3 class="anchored" data-anchor-id="transformation-blocks">Transformation blocks</h3>
<p>Since we are dealing with phasors that rotate at the grid frequency, instead of instantaneous values, the transformation from the <em>abc</em> reference frame to the <em>qd0</em> reference frame can be performed by cancelling or applying the rotation of the phasor.</p>
<p>Assuming we have a complex electrical variable <span class="math display">\[x = Xe^{j\theta}\]</span>, where <span class="math display">\[X\]</span> is the amplitude and <span class="math display">\[\theta\]</span> is the angle of the variable, the transformation to the <em>qd0</em> reference can be done by multiplying by <span class="math display">\[e^{-j\theta_v}\]</span>.</p>
<p>For the <em>abc</em> variables, the phasors will be:</p>
<div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:center; vertical-align: middle; padding:4px 0;">
<p><span class="math display">\[ x_{abc} = \begin{bmatrix} x_a \\ x_b \\ x_c \end{bmatrix} = \begin{bmatrix} Xe^{j\theta} \\ Xe^{j(\theta - \frac{2\pi}{3})} \\ Xe^{j(\theta + \frac{2\pi}{3})} \end{bmatrix} \]</span></p>
</div>
<p>where <span class="math display">\[X\]</span> is the amplitude of the voltage or current, <span class="math display">\[\theta\]</span> is the angle of the voltage or current. Since the system is balanced, the transformation can be calculated using the <span class="math display">\[a\]</span>-phase measurement, and <span class="math display">\[\theta_v = \theta\]</span>. The real and imaginary parts of the product of <span class="math display">\[v_a e^{-j\theta_v}\]</span> will give the <span class="math display">\[v^q\]</span> and <span class="math display">\[v^d\]</span> components of the voltage, respectively.</p>
<p>In case of unbalance system, the method of symmetrical components would have to be used in order to obtain the positive an negative sequence components.</p>
<p>Inversely, the transformation from <em>qd0</em> reference frame to <em>abc</em> can be done by performing the following operation:</p>
<div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:center; vertical-align: middle; padding:4px 0;">
<p><span class="math display">\[ v^a = (v^q + j v^d)e^{j\theta_v} \]</span> <span class="math display">\[ v^b = v^a e^{-j\frac{2\pi}{3}} \]</span> <span class="math display">\[ v^c = v^a e^{j\frac{2\pi}{3}} \]</span></p>
</div>
</section>
<section id="angle-and-frequency-tracking" class="level3">
<h3 class="anchored" data-anchor-id="angle-and-frequency-tracking">Angle and frequency tracking</h3>
<p>Instead of having a PLL, the direct measurement of the voltage of the grid will provide its angle <span class="math display">\[\theta\]</span>. The frequency of the grid is obtained by differentiating the angle, using the value of the angle of the previous iteration (or <span class="math display">\[\theta_0\]</span> for the first time step) and the current value, as well as the time step:</p>
<div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:center; vertical-align: middle; padding:4px 0;">
<p><span class="math display">\[ \omega = \frac{\theta_i - \theta_{i-1}}{\Delta t} \]</span></p>
</div>
<p>This tracking, alongside the transformations mentioned in the previous section, can be represented by the following block diagram:</p>
<div style="background-color:rgba(0, 0, 0, 0); text-align:center; vertical-align: middle; padding:4px 0;">
<img src="{{ 'Phasor_qd0_GF.svg'}}" alt="Angle Tracking Diagram" style="float: center; margin-right: 10px; width: 500px;">
</div>
<div data-align="center">
<p>Figure 2: Angle Tracking and dq0 Transformation Diagram</p>
</div>
<p><br></p>
<p>The dynamics of the grid tracking are completely dismissed using this approach, which has led to some developments in order to simulate these dynamics using the closed-loop transfer function <a href="#6">[6]</a>:</p>
<div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:center; vertical-align: middle; padding:4px 0;">
<p><span class="math display">\[ \frac{\theta_v'(s)}{\theta_v(s)} = \frac{s \tau_{pll} + 1}{\frac{s^2}{\omega_{pll}^2} + s\tau_{pll} + 1} \]</span></p>
</div>
<p>where <span class="math display">\[\tau_{pll}\]</span> is the time constant of the PLL and <span class="math display">\[\omega_{pll}\]</span> is the natural frequency of the PLL. This dynamics can be omitted by considering <span class="math display">\[\theta_v'(s) = \theta_v(s)\]</span>.</p>
</section>
<section id="current-control" class="level3">
<h3 class="anchored" data-anchor-id="current-control">Current control</h3>
<p>The same current control as in the EMT model is used to determine the converter voltage that has to be applied in order to maintain the current at the setpoint. The model uses the Internal Model Control method (IMC), described in <a href="#7">[7]</a>, which provides PI controllers tuned in terms of the machine parameters (in this case <span class="math display">\[R\]</span> and <span class="math display">\[L\]</span>) with the desired response. The control is based on the following block diagram:</p>
<div style="background-color:rgba(0, 0, 0, 0); text-align:center; vertical-align: middle; padding:4px 0;">
<img src="{{ 'CurrentControlDiagram.svg'}}" alt="Current Control Diagram" style="float: center; margin-right: 10px; width: 700px;">
</div>
<div data-align="center">
<p>Figure 3: Current Control Diagram <a href="#3">[3]</a></p>
</div>
<p><br></p>
<p>The RL filter has been used so the dynamics of the current loop are the same as in the EMT model, described by the Laplace transform of the voltage and current relationships:</p>
<div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:center; vertical-align: middle; padding:4px 0;">
<p><span class="math display">\[ i^{q*}_c = \frac{v^{q*}_c - v^{q}_g - \omega_g L i^d_c}{R + sL} = \frac{\hat{v}^q}{R + sL}\]</span> <span class="math display">\[ i^{d*}_c = \frac{v^{d*}_c - v^{d}_g + \omega_g L i^q_c}{R + sL} = \frac{\hat{v}^d}{R + sL}\]</span></p>
</div>
<p>where <span class="math display">\[v^{q*}_c\]</span> and <span class="math display">\[v^{d*}_c\]</span> are the setpoints of the converter voltage, <span class="math display">\[v^{q}_g\]</span> and <span class="math display">\[v^{d}_g\]</span> are the grid voltage measurements, <span class="math display">\[i^{q*}_c\]</span> and <span class="math display">\[i^{d*}_c\]</span> are the setpoints of the converter current, and <span class="math display">\[i^{q}_c\]</span> and <span class="math display">\[i^{d}_c\]</span> are the converter current measurements. Although <span class="math display">\[i^{qd*}_c\]</span> is directly considered to be the converter current without any modulation, a different notation for its measurement is used (<span class="math display">\[i^{qd}_c\]</span>) to differentiate it.</p>
<p>The open-loop transfer function is given by:</p>
<div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:center; vertical-align: middle; padding:4px 0;">
<p><span class="math display">\[ \frac{i^{qd*}_c(s)}{\hat{v}^{qd}(s)} = \frac{1}{R + sL} \]</span></p>
</div>
<p>The following schematic represents the closed-loop block diagram for the current loop:</p>
<div style="background-color:rgba(0, 0, 0, 0); text-align:center; vertical-align: middle; padding:4px 0;">
<img src="{{ 'CurrentErrorVSC_Phasor.svg'}}" alt="Current Error Diagram" style="float: center; margin-right: 10px; width: 700px;">
</div>
<div data-align="center">
<p>Figure 4: Current Error Diagram</p>
</div>
<p><br></p>
<p>The transfer function of this block diagram, considering <span class="math display">\[G_c = K^{icl}_p + \frac{K^{icl}_i}{s}\]</span> is:</p>
<div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:center; vertical-align: middle; padding:4px 0;">
<p><span class="math display">\[ \frac{i^{qd*}_c(s)}{i^{qd*}(s)} = \frac{G_c(s)}{Ls + R + G_c(s)} \]</span></p>
</div>
<p>where <span class="math display">\[i^{qd*}(s)\]</span> is the reference current for <em>q</em> or <em>d</em> axis, <span class="math display">\[i^{qd*}_c(s)\]</span> is the converter current. The controller gains can be selected as <span class="math display">\[K^{icl}_p = \frac{L}{\tau_c}\]</span> and <span class="math display">\[K^{icl}_i = \frac{R}{\tau_c}\]</span>, where <span class="math display">\[\tau_c\]</span> is the time constant of the current loop, such that the complete closed-loop transfer function is represented as the following first-order response:</p>
<div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:center; vertical-align: middle; padding:4px 0;">
<p><span class="math display">\[ \frac{i^{qd*}_c(s)}{i^{qd*}(s)} = \frac{1}{\tau_c s + 1} \]</span></p>
</div>
<p>The resulting PI controller is the following:</p>
<div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:center; vertical-align: middle; padding:4px 0;">
<p><span class="math display">\[ G_{c}(s) = K_p + \frac{K_i}{s} = \frac{L}{\tau_c} + \frac{R}{\tau_c s} \]</span></p>
</div>
<p>The converter voltage setpoint obtained from this loop (<span class="math display">\[v_c^{qd*}\]</span>) can be used to determine the current of the equivalent sources of the converters when used in the relationship for <span class="math display">\[i^{q*}_c\]</span> and <span class="math display">\[i^{d*}_c\]</span> (not to be confused with <span class="math display">\[i^{qd*}\]</span>, which are the setpoints obtained in the current control loop).</p>
</section>
<section id="active-and-reactive-power-control" class="level3">
<h3 class="anchored" data-anchor-id="active-and-reactive-power-control">Active and reactive power control</h3>
<p>The previous section made use of the current setpoints to control the converter. As in the EMT model, they can be determined directly by the user, or they can be obtained from the power setpoints (P<em>, Q</em>), which would still come from the user. To derive the controls, firstly the instantaneous power theory <a href="#8">[8]</a> is described briefly for the synchronous frame <em>dq0</em>.</p>
<p>The voltage and current phasors can be expressed in the <em>dq0</em> frame as:</p>
<div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:center; vertical-align: middle; padding:4px 0;">
<p><span class="math display">\[ v^{qd} = \frac{v^q - jv^d}{\sqrt{2}} \]</span> <span class="math display">\[ i^{qd} = \frac{i^q - ji^d}{\sqrt{2}} \]</span></p>
</div>
<p>The complex power phasor, as well as the active and reactive power values, can now be obtained with:</p>
<div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:center; vertical-align: middle; padding:4px 0;">
<p><span class="math display">\[ \underline{S} = 3 v^{qd}(i^{qd})^* = 3 (\frac{v^q - jv^d}{\sqrt{2}})(\frac{i^q + ji^d}{\sqrt{2}})\]</span> <span class="math display">\[ P = \Re(S) = \frac{3}{2} (v^q i^q + v^d i^d) \]</span> <span class="math display">\[ Q = \Im(S) = \frac{3}{2} (v^q i^d - v^d i^q) \]</span></p>
</div>
<p>As a design choice of the PLL, <span class="math display">\[v_d = 0\]</span> to track the grid angle. Then, the expressions for current setpoints can be extracted substituting in the previous equation:</p>
<div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:center; vertical-align: middle; padding:4px 0;">
<p><span class="math display">\[ i^{q*} = \frac{2}{3} \frac{P^*}{v^q} \]</span> <span class="math display">\[ i^{d*} = \frac{2}{3} \frac{Q^*}{v^q} \]</span></p>
</div>
<p>This relationship can be used to calculate directly the current setpoint for a given value of <span class="math display">\[v^q\]</span>, which could be considered constant if the grid voltage is stable, or it can come directly from the voltage measurements. However, it is not robust when there are transient phenomena or perturbations in the grid voltage. To have a smoother response, a power loop is designed to control the current setpoints using a PI controller. The following block diagram shows the current setpoints output using the power setpoints:</p>
<div style="background-color:rgba(0, 0, 0, 0); text-align:center; vertical-align: middle; padding:4px 0;">
<img src="{{ 'PowerLoopVSC.svg'}}" alt="Power Control Diagram" style="float: center; margin-right: 10px; height: 180px;">
</div>
<div data-align="center">
<p>Figure 5: Power Control Diagram <a href="#3">[3]</a></p>
</div>
<p><br></p>
<p>To determine the PI controller parameters, we include the current loop as the plant of the power loop, in order to obtain a response that accounts for the inner-loop dynamics. The following block diagram shows the complete power loop:</p>
<div style="background-color:rgba(0, 0, 0, 0); text-align:center; vertical-align: middle; padding:4px 0;">
<img src="{{ 'ErrorPowerLoopVSC.svg'}}" alt="Power Control Diagram" style="float: center; margin-right: 10px; height: 280px;">
</div>
<div data-align="center">
<p>Figure 6: Closed-Loop Power Control Diagram</p>
</div>
<p><br></p>
<p>Following a similar procedure to the one of the current loop, the closed-loop transfer function of the power loop can be modelled as a first-order system:</p>
<div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:center; vertical-align: middle; padding:4px 0;">
<p><span class="math display">\[ \frac{P(s)}{P^*(s)} = \frac{Q(s)}{Q^*(s)} = \frac{1}{\tau_p s + 1} \]</span></p>
</div>
<p>where <span class="math display">\[\tau_p\]</span> is the time constant of the power loop. The PI controller can be obtained with the use of the time constant of the current loop as:</p>
<div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:center; vertical-align: middle; padding:4px 0;">
<p><span class="math display">\[K^{ipl}_p = \frac{2\tau_c}{3V_{peak}\tau_p}\]</span> <span class="math display">\[K^{ipl}_i = \frac{2}{3V_{peak}\tau_p}\]</span></p>
</div>
<p>where <span class="math display">\[V_peak\]</span> is used to tune the controller constant since <span class="math display">\[v^q\]</span> will be close to this value. The time constant <span class="math display">\[\tau_p\]</span> will be larger than <span class="math display">\[\tau_c\]</span>, since the power loop is designed to have a slower response than the current loop.</p>
</section>
<section id="limitations-of-current" class="level3">
<h3 class="anchored" data-anchor-id="limitations-of-current">Limitations of current</h3>
<p>The technical constraints of the VSC can be included in the controls using saturation blocks. Depending on the desired operation mode, the converter can be set to prioritize one of the current components. These operation modes are typically defined by the grid codes, although a possible implementation could be the following:</p>
<ul>
<li><strong>Normal operation</strong>: The converter will follow the <span class="math display">\[i^q\]</span> component setpoint, prioritizing the active power, and then <span class="math display">\[i^d\]</span> will be limited by the operational limits of the converter <span class="math display">\[i^d_{max} = \sqrt{I_{max}^2 - \max{i^q, i^{q*}}} \]</span>.</li>
<li><strong>Transient or fault operation</strong>: The converter will now prioritize the <span class="math display">\[i^d\]</span> component, which will follow its reference, and <span class="math display">\[i^q_{max} = \sqrt{I_{max}^2 - \max{i^d, i^{d*}}^2} \]</span>.</li>
</ul>
<p>More details on how the anti-windup controls are implemented can be found in the <a href="../EMTGridFollowingVSC/">EMT Grid Following page</a>.</p>
</section>
</section>
<section id="derived-models" class="level2">
<h2 class="anchored" data-anchor-id="derived-models">Derived Models</h2>
<p>The model presented can have some of its dynamics simplified in order to perform low-frequency domain studies with higher time step (which means, faster execution times). Listed below, ordered from high to low accuracy, some of this models with its assumptions are presented:</p>
<ul>
<li><p><a href="./PhasorI1/"><strong>Phasor <span class="math display">\[I_1\]</span></strong></a>: The dynamics of the current loop are approximated by a first-order transfer function with a given time constant <span class="math display">\[\tau_c\]</span>.</p></li>
<li><p><a href="./PhasorIo/"><strong>Phasor <span class="math display">\[I_0\]</span></strong></a>: The current loop is completely removed (as it has the fastest dynamics of the system), which requires a reformulation of the power loop. The output of the later will be directly considered as the converter current.</p></li>
<li><p><a href="./PhasorPQ1/"><strong>Phasor <span class="math display">\[PQ_1\]</span></strong></a>: The dynamics of the power loop are approximated by a first-order transfer function with a given time constant <span class="math display">\[\tau_{pq}\]</span>, similarly to the first case. The current loop is also removed.</p></li>
</ul>
<p>The following figure (which corresponds to Figure 6 of <a href="#1">[1]</a>) depicts the performance for all these models compared to the EMT model in one particular scenario, in which the power setpoint tracking for <span class="math display">\[P^*, Q^*\]</span> was studied:</p>
<div style="background-color:rgba(0, 0, 0, 0); text-align:center; vertical-align: middle; padding:4px 0;">
<img src="{{ 'ErrorPlot_Phasor.svg'}}" alt="Phasor Models Comparison" style="float: center; margin-right: 10px; width: 700px;">
</div>
<div data-align="center">
<p>Figure 7: Phasor Models Error Comparison <a href="#1">[1]</a></p>
</div>
<p><br></p>
<p>As a summary, the Full-Phasor model is proven as a reliable although slower model. It is capable to solve with good accuracy the system for time step sizes that are outside the convergence range of the EMT model. The <span class="math display">\[I_0\]</span> and <span class="math display">\[I_1\]</span> Phasor models are able to reach convergence at bigger time steps with a decent accuracy (around <span class="math display">\[10^3\]</span> <span class="math display">\[\mu s\]</span>), while the <span class="math display">\[PQ_1\]</span> model is the fastest but with a good accuracy compared to the rest of the models for bigger time steps. Generally, choosing between one or other model depends on the time step size desired to use, rather than the type of study, as all the phasor models can work in a similar range of frequencies, as seen in the following figure:</p>
<div style="background-color:rgba(0, 0, 0, 0); text-align:center; vertical-align: middle; padding:4px 0;">
<img src="{{ 'Phasor_suitability.svg'}}" alt="Phasor Models Suitability" style="float: center; margin-right: 10px; width: 500px;">
</div>
<div data-align="center">
<p>Figure 8: Phasor Models Suitability <a href="#1">[1]</a></p>
</div>
<p><br></p>
<p>The details can be consulted in:</p>
<p>{% include subfolderNav.html %}</p>
</section>
<section id="open-source-implementations" class="level2">
<h2 class="anchored" data-anchor-id="open-source-implementations">Open source implementations</h2>
<p>No open-source implementations have been found.</p>
</section>
<section id="table-of-references" class="level2">
<h2 class="anchored" data-anchor-id="table-of-references">Table of references</h2>
<p><a id="1">[1]</a> Lacerda, V. A.; Prieto-Araujo, E.; Cheah, M.; Gomis-Bellmunt, O. “Phasor Modeling Approaches and Simulation Guidelines of Voltage-Source Converters in Grid-Integration Studies”, May 2022, IEEE Access, DOI: <a href="https://doi.org/10.1109/ACCESS.2022.3174958">10.1109/ACCESS.2022.3174958</a></p>
<p><a id="2">[2]</a> Lacerda, V. A.; Prieto-Araujo, E.; Cheah, M.; Gomis-Bellmunt, O. “Phasor and EMT models of grid-following and grid-forming converters for short-circuit simulations.”, October 2023, vol.&nbsp;223, núm. 109662. DOI: <a href="https://doi.org/10.1016/j.epsr.2023.109662">10.1016/j.epsr.2023.109662</a></p>
<p><a id="3">[3]</a> Egea, A.; Junyent-Ferré, A.; Gomis-Bellmunt, O. “Active and reactive power control of grid connected distributed generation systems”. Part of: “Modeling and control of sustainable power systems”. 2012, p.&nbsp;47-81.</p>
<p><a id="4">[4]</a> Clarke, E., “Circuit Analysis Of A-c Power System Vol I”, John Wiley and Sons, 1941</p>
<p><a id="5">[5]</a> Park, R. H., “Two-reaction theory of synchronous machines generalized method of analysis-part I”, AIEE Transactions, Vol. 48, Issue 3, July 1929. DOI: <a href="https://doi.org/10.1109/T-AIEE.1929.5055275">10.1109/T-AIEE.1929.5055275</a></p>
<p><a id="6">[6]</a> Villegas Pico, H. N., &amp; Johnson, B. B. (2019). Transient Stability Assessment of Multi-Machine Multi-Converter Power Systems. IEEE Transactions on Power Systems, 1–1. DOI: <a href="https://doi.org/10.1109/tpwrs.2019.2898182">10.1109/TPWRS.2019.2898182</a></p>
<p><a id="7">[7]</a> Harnefors, L.; Nee, H. P. “Model-Based Current Control of AC Machines Using the Internal Model Control Method”. IEEE Transactions on Industrial Applications, Vol. 34, No.&nbsp;1, January/February 1998, DOI: <a href="https://doi.org/10.1109/28.658735">10.1109/28.658735</a></p>
<p><a id="8">[8]</a> Akagi, H., Watanabe, E., Aredes, M.: “Instantaneous power theory and Applications to power conditioning”. Wiley, Chichester (2007)</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/CRESYM\.github\.io\/Colib_Quarto\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright © 2023-2025 Authors of Collaborative Open-Source Dynamic Simulation Library. Content licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY-4.0</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../../../about/index.html">
<p>About</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../../../contact.html">
<p>Contact</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://cresym.eu/privacy-policy/">
<p>Privacy Policy</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../../../about/terms.html">
<p>Terms of Reference</p>
</a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/CRESYM/Colib_Quarto.github.io">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>