---
title: "Underfrequency load shedding scheme based on System frequency response model"
tags: ['#154', opensource, System frequency response model, centre of inertia, underfrequency load shedding, low frequency demand disconnection, Python, Matlab, Simulink] 
date: 03/06/2024  
last-updated: 03/06/2024 
author: Urban Rudez
reviewer: Mathilde Bongrain
bibliography: ../../../../_bibliography/references.bib
---

## Context

System frequency response model (SFRM) is useful for representing frequency behavior of an electric power system after a sudden power imbalance occurs. It was developed to average the dynamic behavior of multiple synchronous machines into an equivalent single-generator unit model. It filters out all inter-generator oscillations and provides the average electric power system frequency response. SFRM was first introduced in [@Anderson1990] and was utilized in several publications since then.

UFLS is incorporated to SFRM as an additional feedback function (see Model description for more details). Apart from conventional UFLS algorithm, this model includes an innovative UFLS ([@Rudez2022], [@Rudez2021]) proposed by University of Ljubljana, Slovenia, with two different types of settings ( the shapes of tripping curves in f-M plane can be either L-shaped like in Fig. 5b (L-shaped) or ellipse-shaped like in Fig. 5c).

This model has been developed in the context of XX project which aims at studying the XX.

## Model use, assumptions, validity domain and limitations

SFRM can be very handy for studying different frequency-control mechanisms, including Under-Frequency Load Shedding (UFLS), often referred to as Low-Frequency Demand Disconnection (LFDD). UFLS is governed by the system frequency and decreases system consumption once certain criteria are met. Depending on the criteria, a variety of UFLS algorithms exist in the literature [@Skrjanc2023], among which conventional frequency-threshold-based UFLS algorithm is prevailing. In the past, this type of system integrity protection scheme was rarely activated due to abundance of rotational masses, synchronized to the electrical power system. Namely, the so-called system inertia $H$ has a stabilizing effect on electric-power frequency, making it very resilient to power imbalances. However, by replacing conventional generation with converter-interfaced sources without any rotational masses, system inertia is decreasing and as a result, the sensitivity to power imbalances is increasing. This calls for new frequency control and protection strategies, which can be easily studied using SFRM.

Most of the researchers agree that the flexibility of conventional UFLS is insufficient, especially under low-inertia conditions and uncertain stage sizes due to DER. Load disconnection based on frequency alone is simply inappropriate and offers poor adaptability. This is why numerous attempts can be found in the literature to increase UFLS adaptability to various operating conditions. One such innovation, developed at University of Ljubljana (noted as UL-UFLS) and presented in this model, takes advantage of frequency and its rate of change (rate-of-change-of-frequency - $RoCoF$) to add a second tripping criterion alongside frequency violation. Source [@Rudez2021] defines a frequency stability margin $M(t)$, whose pros and cons were extensively discussed in [@Rudez2019], [@Vadillo2023], [@Rudez2019b], [@Sodin2020], [@Bonetti2020].

## Model description

### System frequency response model

As illustrated in Fig. 1, the SFRM model consists of two transfer functions: $TF_1$ represents a swing equation, providing mathematical formulation of a synchronous machine rotor motion, and $TF_2$, covering a behavior of the speed governors and the turbines:

$$
\begin{align}
TF_1 (s) &= \frac{1}{2 H s+D} \tag{1} \\
TF_2 (s) &= \frac{K_{\text{m}}(1+F_{\text{H}} T_{\text{R}} s)}{R(1+T_{\text{R}} s)} \tag{2}
\end{align}
$$

where:

- $H$ is inertia constant in seconds,
- $D$ is damping factor,
- $K_m$ is mechanical power gain factor,
- $F_H$ is a fraction of total power generated by the high-pressure turbine,
- $T_R$ is reheating time constant in seconds and
- $R$ is a droop constant.

In Fig. 1, variables Î”$P$ represent an initial power imbalance (usually a step-like function) and $P_m$ power provided by governor control.

### Underfrequency load shedding

 UFLS is incorporated to SFRM as an additional feedback function providing $P_{UFLS}$, as seen in Fig. 1. The impact of UFLS on acceleration power $P_a$ is nonlinear, since UFLS provides discrete actions.

 Apart from conventional UFLS algorithm, the model includes an innovative UFLS ([@Rudez2022], [@Rudez2021] intellectual property of University of Ljubljana, Slovenia), with two different types of settings.

![System frequency response model (SFRM)](Fig1_SFRM.jpg){#fig-sfrm}

::: {#fig-sfrm}
System frequency response model (SFRM) linear transfer function with non-linear UFLS (LFDD)
:::

Conventional UFLS is designed to operate via activation of numerous frequency relays, scattered across several medium voltage substations (see Fig. 2). Triggering criteria is a violation of a frequency threshold setting $f_{thr}$. The basic idea of conventional UFLS is to provide identical frequency threshold settings to selected groups of relays, making them act simultaneously. Each of these groups, containing relays from different locations in the network, is usually referred to as an UFLS stage. Most often, a transmission system operator (TSO) defines UFLS requirements, that are to be implemented by a distribution system operator (DSO). For the conventional UFLS, requirements are the following:

- number of stages (in Fig. 2 example equals 5),
- stage frequency thresholds,
- stage size (load decrease) and
- sum of all stage sizes.

![Frequency relay designation to UFLS stages](Fig2_UFLS_in_subs.jpg){#fig-relay-stages}

::: {#fig-relay-stages}
Frequency relay designation to UFLS stages
:::

Appointment of relays that take part in each stage is a matter of DSO and so is the recurring period in which appointment is made. In practice, most of the conventional UFLS encompass up to 10 stages with frequency thresholds distributed evenly between 96% and 98% of the rated system frequency. Usually, relays are grouped into stages based on their average yearly power, yet increasing penetration of distributed energy resources (DER) dictates the need for more frequent (or even real-time) evaluation of appointments.

**Additional tripping criterion**

In order to  increase UFLS adaptability to various operating conditions, this model embed a second tripping criterion alongside frequency violation as proposed by University of Ljublana. This second criterion takes advantage of frequency and its rate of change (rate-of-change-of-frequency - $RoCoF$) in this way:

$$if \; f<f_{set}, then \: Trip = 1, Else \: Trip = 0$$

where $f_{set}$ is the frequency criterion in Hz and is defined differently for L-shaped tripping curve:

$$if \; M< M_{set}, then \: f_{set} = f_{threshold}, else \: f_{set} = 0$$

than for  ellipse-shaped tripping curve:

$$f_{set} = f_{LIM} + \sqrt{(1 - \frac{M^2}{M_{set}^2}) *  (f_{threshold} - f_{LIM})^2}$$

where:

- $M(t)$ is the instantaneous frequency Margin in seconds
- $M_{set}$ is the frequency margin setpoint value in seconds
- $f_{LIM}$ is the frequency limit in Hz
- $f_{threshold}$ is the frequency threshold in Hz

**Frequency stability margin**

This new margin criterion aims at avoiding unnecessary shedding (overshedding) when the frequency is about to be stabilized by frequency control.

$M(t)$ is defined as follows:

$$
\begin{align}
M (t) = \frac{f_{\text{LIM}} - f(t)}{RoCoF(t)} \tag{3}
\end{align}
$$

where:

- $f(t)$ represents the instaneous frequency in Hz
- $f_{LIM}$ is the frequency threshold in Hz
- $RoCoF(t)$ is the rate-of-change-of-frequency in Hz/s

For understanding purposes, physical meaning of $M(t)$ and its variation through time are represented graphically by Fig. 3. Fig. 3a depicts frequency response of an electric power system after negative power imbalance occurs at moment denoted with "event", whereas $M(t)$ at two instances $M(t_1)$ and $M(t_2)$ is shown in Fig. 3b.

![Graphical representation of frequency-stability margin](Fig3_UFLS_inn.jpg){#fig-margin-calc}

::: {#fig-margin-calc}
Graphical representation of frequency-stability margin $M(t)$ calculation (a) and $M(t)$ variation through time (b) after a negative power imbalance occurs
:::

Frequency stability margin $M(t)$ is transparently adopted to UFLS by depicting a trajectory of the operating point in the frequency $f(t)$ versus frequency stability margin $M(t)$ diagram ($f$-$M$ plane). In Fig. 4a, several frequency response curves are depicted, among which red, black and blue are of interest. Red curve represents a stable case in which there is no need for UFLS activation. Black curve shows somewhat a borderline case in which frequency is indeed stabilized without UFLS, yet it reaches very low frequency values. A blue case is clearly unstable, meaning that UFLS activation is required. A corresponding three trajectories in $f$-$M$ diagram are depicted in Fig. 4b, from which it is obvious that vicinity to lower-left hand side corner of the $f$-$M$ diagram can be considered as a tripping criterion.

![Different system frequency responses](Fig4_fM_diag.jpg){#fig-freq-responses}

::: {#fig-freq-responses}
Different system frequency responses with respect to time (a) and corresponding trajectories in $f$-$M$ plane (b)
:::

One has numerous possibilities for defining the shape of tripping curves in $f$-$M$ plane. In the presented use cases, we apply three of them, depicted in Fig. 5. Horizontal tripping lines in Fig. 5a correspond to $M$-independent conventional UFLS, whereas L-shaped (Fig. 5b) or ellipse-shaped (Fig. 5c) tripping curves indicate two possibilities, that we find most useful for practical applications.

![UFLS setting in f-M plane](Fig5_UFLS_set.jpg){#fig-ufls-settings}

::: {#fig-ufls-settings}
UFLS setting in $f$-$M$ plane: conventional (a), L-shaped UL-UFLS (b), ellipse-shaped UL-UFLS (c)
:::

## Open Source Implementations

| Software      | URL | Last consulted date |
| --------------| --- | --------- |
| $Python$ | [Link](https://github.com/UrRudFe/My_Colib0_contributions) | $03/06/2024$ |
| $Matlab/Simulink$ | [Link](https://github.com/UrRudFe/My_Colib0_contributions) | $03/06/2024$ |

## References

The references are included in the bibliography. 
