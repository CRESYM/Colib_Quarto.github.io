<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Carlos Alegre (eRoots)">
<meta name="dcterms.date" content="2024-03-07">

<title>Generic EMT Grid Forming Voltage Source Converter</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<link href="../../../../../assets/img/Logo_colib.svg" rel="icon" type="image/svg+xml">
<script src="../../../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap-e30c552364bddadb0a23b1c371944251.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../../../styles/main.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../../assets/img/Logo_colib.svg" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../index.html"> 
<span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">About</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-about">    
        <li>
    <a class="dropdown-item" href="../../../../../about/index.html">
 <span class="dropdown-text">About Colib</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../about/authorGuidelines.html">
 <span class="dropdown-text">Author Guidelines</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../about/codeConduct.html">
 <span class="dropdown-text">Code of Conduct</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../about/notationAndConventions.html">
 <span class="dropdown-text">Notations and conventions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../about/team.html">
 <span class="dropdown-text">Teams and community</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../about/terms.html">
 <span class="dropdown-text">Terms of Reference</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-models" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Models</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-models">    
        <li>
    <a class="dropdown-item" href="../../../../../models/index.html">
 <span class="dropdown-text">All models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../models/1-SynchronousMachines/index.html">
 <span class="dropdown-text">Synchronous Machines</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../models/2-Loads/index.html">
 <span class="dropdown-text">Loads</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../models/3-CompensationAndFACTS/index.html">
 <span class="dropdown-text">Compensation and FACTS</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../models/4-HVDC/index.html">
 <span class="dropdown-text">HVDC</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../models/5-RenewablesAndStorage/index.html">
 <span class="dropdown-text">Renewables and Storage</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../models/6-NetworkComponents/index.html">
 <span class="dropdown-text">Network Components</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../models/7-Protection/index.html">
 <span class="dropdown-text">Protection</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../models/8-Others/index.html">
 <span class="dropdown-text">Others</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-test-cases" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Test Cases</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-test-cases">    
        <li>
    <a class="dropdown-item" href="../../../../../testCases/index.html">
 <span class="dropdown-text">All test cases</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../testCases/GridFollowing_GridForming_DClink/index.html">
 <span class="dropdown-text">Grid Following - Grid Forming DC link</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../testCases/kundur_two_area_system/index.html">
 <span class="dropdown-text">Kundur two-area system</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../testCases/converterDrivenStability/index.html">
 <span class="dropdown-text">Converter Driven Stability</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../testCases/System_frequency_response_model_with_underfrequency_load_shedding_protection/index.html">
 <span class="dropdown-text">System Frequency Response Model with Underfrequency Load Shedding Protection</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-contribute" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Contribute</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-contribute">    
        <li>
    <a class="dropdown-item" href="../../../../../contribute/howTo/index.html">
 <span class="dropdown-text">How to contribute</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../contribute/quartoBasics/index.html">
 <span class="dropdown-text">Quarto Basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../contribute/interactiveTutorial/index.html">
 <span class="dropdown-text">Interactive Tutorial</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../contribute/modelTemplate/index.html">
 <span class="dropdown-text">Model template</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../contribute/testSystemTemplate/index.html">
 <span class="dropdown-text">Test case template</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../../../contact/index.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/CRESYM/Colib_Quarto.github.io" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../../models/index.html">Models</a></li><li class="breadcrumb-item"><a href="../../../../../models/4-HVDC/index.html">HVDC</a></li><li class="breadcrumb-item"><a href="../../../../../models/4-HVDC/VSC/index.html">Voltage Source Converter (VSC)</a></li><li class="breadcrumb-item"><a href="../../../../../models/4-HVDC/VSC/GridFormingConverter/index.html">Grid forming converter (GFM)</a></li><li class="breadcrumb-item"><a href="../../../../../models/4-HVDC/VSC/GridFormingConverter/UPC-EMT-GFM-VSC/index.html">Generic EMT Grid Forming Voltage Source Converter</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/1-SynchronousMachines/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Synchronous machines</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/1-SynchronousMachines/Generator/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generator</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Generator/SM1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Synchronous Machine Model (SM1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Generator/GENTPJ/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GENTPF/GENTPJ Synchronous Machine with Saturation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Generator/GENSAL/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GENROU/GENSAL Salient-pole/round-rotor synchronous machine without saturation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Generator/GENQEC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GENQEC Synchronous Machine with Saturation</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Voltage Regulators (AVR) / Exciters (EX)</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/DC1C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DC1C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/BBSEX1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BBSEX1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/AcRotatingExciter/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AcRotatingExciter (submodel)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/ST4C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ST4C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/ST7C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ST7C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/ST1C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ST1C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/AC7C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AC7C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/AC6C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AC6C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/ST9C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ST9C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/AC1C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AC1C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/ST6C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ST6C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/ST5C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ST5C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/IEEEX2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IEEEX2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/AC8C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AC8C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/IEEX2A/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IEEX2A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/ExciterAndVoltageRegulator/SCRX/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SCRX</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Over/under Excitation Limiters</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/OEL3C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OEL3C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/SCL1C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SCL1C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/OEL4C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OEL4C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/UEL1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">UEL1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/OEL5C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OEL5C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/UEL2C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">UEL2C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/SCL2C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SCL2C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/OverUnderExcitationLimiter/OEL2C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OEL2C</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/1-SynchronousMachines/Governor/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Governors (GOV)</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/GovHydro4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GovHydro4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/GovSteamEU/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GovSteamEU</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/TGOV3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TGOV3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/HYGOV/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HYGOV</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/GAST/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GAST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/TGOV1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TGOV1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/IEEEG1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IEEEG1 / GovSteam 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/IEEEG2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IEEEG2 / GovSteam 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/Governor/GovCT2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GovCT2 / GGOV2</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/1-SynchronousMachines/PowerSystemStabilizer/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Power System Stabilizers (PSS)</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/PowerSystemStabilizer/PSS2C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PSS2C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/PowerSystemStabilizer/PSS1A/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PSS1A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/PowerSystemStabilizer/PSS6C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PSS6C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/1-SynchronousMachines/PowerSystemStabilizer/PSS3C/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PSS3C</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/2-Loads/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loads</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/2-Loads/ExpLoad/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exponential Load Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/2-Loads/FDLoad/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frequency Dependent Load Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/2-Loads/ZIPLoad/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ZIP Load Model</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/2-Loads/Motor/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motors</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/2-Loads/Motor/WECC_Motor/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Induction motor model with rotor flux dynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/2-Loads/Motor/SimpleMotor/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Single-cage induction motor model</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/3-CompensationAndFACTS/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Compensation and FACTS</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/3-CompensationAndFACTS/STATCOM/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EMT STATCOM (Grid Following mode)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/3-CompensationAndFACTS/StaticCompensator/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Static Compensator model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/3-CompensationAndFACTS/Capacitors/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Capacitors</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/4-HVDC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HVDC</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4-HVDC/LCC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Line Commutated Converters (LCC)</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/4-HVDC/VSC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Voltage Source Converter (VSC)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/4-HVDC/VSC/GridFollowingConverter/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grid following converter (GFL)</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4-HVDC/VSC/GridFollowingConverter/UPC-EMT-GFL-VSC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">UPC generic EMT Grid Following Voltage Source Converter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4-HVDC/VSC/GridFollowingConverter/L2EP-RMS-GFL-VSC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L2EP generic RMS grid following voltage source converter</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/4-HVDC/VSC/GridFollowingConverter/UPC-RMS-GFL-VSC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Full-Phasor Grid Following Voltage Source Converter</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth5 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4-HVDC/VSC/GridFollowingConverter/UPC-RMS-GFL-VSC/PhasorPQ1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phasor-PQ1 Grid Following Voltage Source Converter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4-HVDC/VSC/GridFollowingConverter/UPC-RMS-GFL-VSC/PhasorI1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phasor-I1 Grid Following Voltage Source Converter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4-HVDC/VSC/GridFollowingConverter/UPC-RMS-GFL-VSC/PhasorIo/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phasor-I0 Grid Following Voltage Source Converter</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/4-HVDC/VSC/Point-to-Point-HVDC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Point-to-Point HVDC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4-HVDC/VSC/Point-to-Point-HVDC/RTE-RMS-Average-HVDC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RTE Average phasor voltage source converter HVDC Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4-HVDC/VSC/Point-to-Point-HVDC/UPC-EMT-HVDC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">UPC generic EMT Point-to-Point HVDC model</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/4-HVDC/VSC/GridFormingConverter/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grid forming converter (GFM)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth4 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4-HVDC/VSC/GridFormingConverter/EPRI-GFM-Converter/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EPRI Grid Forming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4-HVDC/VSC/GridFormingConverter/UPC-RMS-GFM-VSC/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generic Phasor Grid Forming Voltage Source Converter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/4-HVDC/VSC/GridFormingConverter/UPC-EMT-GFM-VSC/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Generic EMT Grid Forming Voltage Source Converter</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/5-RenewablesAndStorage/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Renewables and storage</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/5-RenewablesAndStorage/PV/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Photovoltaics</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/5-RenewablesAndStorage/Storage/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Storage</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/5-RenewablesAndStorage/Storage/Flywheel/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Flywheel model</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/5-RenewablesAndStorage/Wind/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Wind power</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-19" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/5-RenewablesAndStorage/Wind/iec_wt_type3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IEC Wind Turbine Type 3 (Doubly-Fed Induction Generator)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/6-NetworkComponents/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Network Components</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-20" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/6-NetworkComponents/Bus/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Buses</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/6-NetworkComponents/Line/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lines</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-21" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-21" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/6-NetworkComponents/Line/cpLine/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CP Line</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/6-NetworkComponents/Line/piLine/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pi Line</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/6-NetworkComponents/Line/FDLine/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FD Line</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/6-NetworkComponents/Transformers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transformers</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-22" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-22" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/6-NetworkComponents/Transformers/CantileverTransformer/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cantilever Transformer</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/7-Protection/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Protection</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-23" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-23" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/7-Protection/LineProtection/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Line Protection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/7-Protection/MachineProtection/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine Protection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/7-Protection/SystemIntegrityProtectionSchemes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">System integrity protection schemes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/7-Protection/TransformerProtection/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Protection</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/7-Protection/LoadShedding/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Load Shedding</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-24" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-24" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/7-Protection/LoadShedding/UFLS/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Underfrequency load shedding scheme based on System frequency response model</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/8-Others/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Others</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-25" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-25" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/Events/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Events</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../models/8-Others/BasicControlBlocks/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Control block</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-26" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-26" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/BasicControlBlocks/integrator/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Integrator control block with a positive time constant T</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/BasicControlBlocks/deadband/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deadband control block</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/BasicControlBlocks/limiter/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Limiter control block with constant bounds</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/BasicControlBlocks/proportionalIntegralController/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Proportional integral (PI) controller</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/BasicControlBlocks/algebraicEquation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Algebraic equation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/BasicControlBlocks/integratorVariableLimits/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Integrator control block with (positive) time constant T and non-windup variable limits on output</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/BasicControlBlocks/limiterVariableBounds/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Limiter control block with variable bounds</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/BasicControlBlocks/absoluteValue/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Absolute value of input</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/BasicControlBlocks/transferFunction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transfer function between an input and output one time constant</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/BasicControlBlocks/hysteresis/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hysteresis control block</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/BasicControlBlocks/limitedIntegrator/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Integrator control block with (positive) time constant T and non-windup limits on output</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/BasicControlBlocks/limitedProportionalIntegralController/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Proportional integral (PI) controller with non-windup limit on the integral term</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/BasicControlBlocks/2limitedProportionalIntegralController/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Proportional integral (PI) controller with non-windup limit on the integral term and limit on the proportional term</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/BasicControlBlocks/timer/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Timer control block</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../models/8-Others/BasicControlBlocks/switch/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Switch</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#context" id="toc-context" class="nav-link active" data-scroll-target="#context">Context</a></li>
  <li><a href="#model-use-assumptions-validity-domain-and-limitations" id="toc-model-use-assumptions-validity-domain-and-limitations" class="nav-link" data-scroll-target="#model-use-assumptions-validity-domain-and-limitations">Model use, assumptions, validity domain and limitations</a></li>
  <li><a href="#model-description" id="toc-model-description" class="nav-link" data-scroll-target="#model-description">Model description</a>
  <ul class="collapse">
  <li><a href="#clarke-and-park-transformations" id="toc-clarke-and-park-transformations" class="nav-link" data-scroll-target="#clarke-and-park-transformations">Clarke and Park transformations</a></li>
  <li><a href="#synchronization-loop" id="toc-synchronization-loop" class="nav-link" data-scroll-target="#synchronization-loop">Synchronization loop</a></li>
  <li><a href="#voltage-control" id="toc-voltage-control" class="nav-link" data-scroll-target="#voltage-control">Voltage control</a></li>
  <li><a href="#current-control" id="toc-current-control" class="nav-link" data-scroll-target="#current-control">Current control</a></li>
  <li><a href="#limitations-of-current" id="toc-limitations-of-current" class="nav-link" data-scroll-target="#limitations-of-current">Limitations of current</a></li>
  <li><a href="#modulation" id="toc-modulation" class="nav-link" data-scroll-target="#modulation">Modulation</a></li>
  </ul></li>
  <li><a href="#parameter-tuning" id="toc-parameter-tuning" class="nav-link" data-scroll-target="#parameter-tuning">Parameter tuning</a></li>
  <li><a href="#open-source-implementations" id="toc-open-source-implementations" class="nav-link" data-scroll-target="#open-source-implementations">Open source implementations</a></li>
  <li><a href="#table-of-references" id="toc-table-of-references" class="nav-link" data-scroll-target="#table-of-references">Table of references</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../../models/index.html">Models</a></li><li class="breadcrumb-item"><a href="../../../../../models/4-HVDC/index.html">HVDC</a></li><li class="breadcrumb-item"><a href="../../../../../models/4-HVDC/VSC/index.html">Voltage Source Converter (VSC)</a></li><li class="breadcrumb-item"><a href="../../../../../models/4-HVDC/VSC/GridFormingConverter/index.html">Grid forming converter (GFM)</a></li><li class="breadcrumb-item"><a href="../../../../../models/4-HVDC/VSC/GridFormingConverter/UPC-EMT-GFM-VSC/index.html">Generic EMT Grid Forming Voltage Source Converter</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Generic EMT Grid Forming Voltage Source Converter</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Opensource</div>
    <div class="quarto-category">EMT</div>
    <div class="quarto-category">voltage source</div>
    <div class="quarto-category">converter</div>
    <div class="quarto-category">wind</div>
    <div class="quarto-category">pv</div>
    <div class="quarto-category">hvdc</div>
    <div class="quarto-category">Droop Control</div>
    <div class="quarto-category">Virtual Synchronous Machine</div>
    <div class="quarto-category">grid forming</div>
    <div class="quarto-category">PSTess</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Carlos Alegre (eRoots) </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 7, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="context" class="level2">
<h2 class="anchored" data-anchor-id="context">Context</h2>
<p>Voltage Source Converters (VSC) are widely used in power systems for a variety of applications, such as wind and photovoltaic generation, High Voltage Direct Current (HVDC) transmission, and Flexible AC Transmission Systems (FACTS). The model described here is a detailed Electromagnetic Transient (EMT) model of a grid-forming VSC, which is a type of VSC that, compared to the Grid Following (which follows the grid rotation) are capable of imposing a determined angle and frequency. This model, obtained from the many works developed at CITCEA-UPC (Centre dInnovaci Tecnolgica en Convertidors Esttics i Accionaments) such as <a href="#1">[1]</a>, is useful for studying the fast-dynamics of the VSC and its interaction with the grid.</p>
</section>
<section id="model-use-assumptions-validity-domain-and-limitations" class="level2">
<h2 class="anchored" data-anchor-id="model-use-assumptions-validity-domain-and-limitations">Model use, assumptions, validity domain and limitations</h2>
<p>The model use is to perform EMT studies involving Grid Forming VSCs. It is valid for the study of the fast dynamics of the VSC and its interaction with the grid. The model is based on the following assumptions:</p>
<ul>
<li>The system is balanced and sinusoidal.</li>
<li>The VSC is represented by three equivalent voltage sources.</li>
<li>Frequency and angle reference are obtained using a reference frequency and a synchronization loop, which can be a virtual synchronous machine or a droop control.</li>
<li>The voltage setpoint is obtained from the reactive power droop control.</li>
<li>The Voltage Controller provides a current reference from a voltage reference.</li>
<li>The Current Controller provides the converter voltage.</li>
<li>Calculations of power have been done following the instantaneous power theory <a href="#2">[2]</a>.</li>
</ul>
<p>The model is valid for high-frequency phenomena studies, such as short-circuit calculations, energization studies, switching transients, traveling waves or lightning events. Lower frequency studies can be performed, but since there is a limitation over the time-step size due to convergence issues (it has to be a couple of orders of magnitude smaller than the lowest time-constant of all the controllers), they are much slower than using a phasor-based model. The model is not valid for harmonic studies, since it does not consider the switching process, and the output voltage is considered to be sinusoidal.</p>
</section>
<section id="model-description" class="level2">
<h2 class="anchored" data-anchor-id="model-description">Model description</h2>
<p>The model can be described with the following schematic:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="EMT_GFM_VSC.svg" class="img-fluid figure-img"></p>
<figcaption>EMT GF VSC scheme</figcaption>
</figure>
</div>
<div class="figure-caption">
<p>Figure 1: EMT Grid Forming VSC scheme <a href="#1">[1]</a></p>
</div>
<p>It is important to note that the currents are measured both at the point of connection of the capacitor filter <span class="math inline">\(v_f\)</span> and at the grid side <span class="math inline">\(v_g\)</span>, while the currents are measured before the filter at converter side <span class="math inline">\(i_c\)</span> and after the filter at the grid side <span class="math inline">\(i_g\)</span>. Starred notation, such as <span class="math inline">\(v_c^{qd*}\)</span>, is used to denote setpoints, in this case the voltage for the equivalent sources of the converter.</p>
<p>The existence of modelling this type of filter (an LCL rather than the single L filter used in Grid Following) is due to the usage of a Grid Forming VSC, which can blackstart a network for example. The more complex filter is used to reduce the harmonic distortion of the output voltage and increase the robustness of the control, which is important in this type of application.</p>
<section id="clarke-and-park-transformations" class="level3">
<h3 class="anchored" data-anchor-id="clarke-and-park-transformations">Clarke and Park transformations</h3>
<p>Assuming a three-phase balanced system, the electrical variables can be expressed in the <em>abc</em> reference frame as:</p>
<p><span class="math display">\[
\begin{align}
x_{abc} = \begin{bmatrix} x_a \\ x_b \\ x_c \end{bmatrix} = \begin{bmatrix} \sqrt{2} X \cos(\theta) \\ \sqrt{2}X \cos(\theta - \frac{2\pi}{3}) \\ \sqrt{2}X \cos(\theta + \frac{2\pi}{3}) \end{bmatrix}
\end{align}
\]</span></p>
<p>where <span class="math inline">\(X\)</span> is the amplitude of the voltage or current, <span class="math inline">\(\theta\)</span> is the angle of the voltage or current. The Clarke transformation <a href="#3">[3]</a> is used to convert the three-phase variables into an orthogonal reference frame. The transformation matrix is given by:</p>
<p><span class="math display">\[
T_{\text{Clarke}} = \frac{1}{3} \begin{bmatrix} 2 &amp; -1 &amp; -1 \\ 0 &amp; \sqrt{3} &amp; -\sqrt{3} \\ 1 &amp; 1 &amp; 1 \end{bmatrix}
\]</span></p>
<p>which applied to the <em>abc</em> variables in balanced conditions, results in the <em><span class="math inline">\(\alpha\beta0\)</span></em> variables:</p>
<p><span class="math display">\[
\begin{align}
x_{\alpha\beta0} = T_{Clarke} x_{abc} = \begin{bmatrix} x_{\alpha} \\ x_{\beta} \\ x_0 \end{bmatrix} = \begin{bmatrix} \sqrt{2} X \cos(\theta) \\ - \sqrt{2}X \sin(\theta)  \\ 0\end{bmatrix}
\end{align}
\]</span></p>
<p>noting that <span class="math inline">\(x_0 = 0\)</span> since it is a balanced system. The electrical variables in this new reference are still sinusoidal. It is desirable to have constant valued variables to be able to implement typical PI control over the signal more easily. This is done using the Park transformation <a href="#4">[4]</a>, converting the <em><span class="math inline">\(\alpha\beta\)</span></em> variables into a rotating reference frame. The transformation matrix is given by:</p>
<p><span class="math display">\[
T_{\text{Park}}(\hat{\theta}) = \begin{bmatrix} \cos(\hat{\theta}) &amp; -\sin(\hat{\theta}) \\ \sin(\hat{\theta}) &amp; \cos(\hat{\theta}) \end{bmatrix}
\]</span></p>
<p>which applied to the <em><span class="math inline">\(\alpha\beta\)</span></em> variables, results in the <em><span class="math inline">\(dq0\)</span></em> variables:</p>
<p><span class="math display">\[
\begin{align}
x_{qd0} = \begin{bmatrix} x_{q} \\ x_{d} \end{bmatrix} = \begin{bmatrix} \sqrt{2} X \cos(\theta - \hat{\theta})  \\ \sqrt{2} X \sin(\theta - \hat{\theta}) \end{bmatrix}
\end{align}
\]</span></p>
<p>As it can be seen, the Park transformation is dependent of the angle <span class="math inline">\(\hat{\theta}\)</span>, which is the angle of the rotating reference frame, and it can be different to the angle of the voltage <span class="math inline">\(\theta\)</span>. If the electrical variable is synchronized with the rotating reference frame, then <span class="math inline">\(\theta = \hat{\theta}\)</span> and <span class="math inline">\(x_d = 0\)</span>.</p>
</section>
<section id="synchronization-loop" class="level3">
<h3 class="anchored" data-anchor-id="synchronization-loop">Synchronization loop</h3>
<p>In this section, the two main synchronization loop methods for the Grid Forming VSC, the droop control method <a href="#5">[5]</a> and the Virtual Synchronous Machine <a href="#6">[6]</a> are presented. These controls determine the voltage magnitude and angle that the grid forming will use to operate. There are other alternatives <a href="#5">[5]</a>, although the most studied are the ones presented in this model. The droop control method is simpler and it has been proven to be a special case of the virtual synchronous machine method <a href="#7">[7]</a>, while the second one produces slower rates of change of the frequency due to the existence of virtual inertia in stand-alone situations.</p>
<p><strong>Droop control</strong></p>
<p>In the present model, the frequency of the VSC is determined using a synchronization loop that involves an active power droop. Considering a reference grid frequency <span class="math inline">\(\omega^*\)</span> (normally 50 Hz), the converter frequency will be adjusted around this value considering the active power error, since active power and voltage phases are related in largely inductive grids as in the transmission system. The droop equation is given by:</p>
<p><span class="math display">\[
K_{\Delta P} = \frac{\Delta \omega}{\Delta P}
\]</span></p>
<p>where the droop constant <span class="math inline">\(K_{\Delta P}\)</span> is the slope of the droop curve, normally determined by grid codes in terms of the percentual variation of the frequency with respect to a variation of the active power. In addition to this droop control, it is common to apply a low-pass filter to the power measurement: <span class="math inline">\(\frac{1}{\tau_{\Delta P} s + 1}\)</span>, with <span class="math inline">\(\tau_{\Delta P} = \frac{1}{\omega_{\Delta P}}\)</span> and <span class="math inline">\(\omega_{\Delta P}\)</span> the bandwith of the filter. This avoids having higher harmonics in the frequency signal. The block diagram of the synchronization loop is shown in the following figure:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="SynchronizationLoopGFM.svg" class="img-fluid figure-img"></p>
<figcaption>Synchronization Loop Diagram</figcaption>
</figure>
</div>
<div class="figure-caption">
<p>Figure 2: Synchronization Loop Diagram</p>
</div>
<p>Similar to the controls applied over the active power, the reactive power output of the converter is related to the voltage magnitude. In this case, the droop equation is given by:</p>
<p><span class="math display">\[
K_{\Delta Q} = \frac{\Delta Q}{\Delta V}
\]</span></p>
<p>where the droop constant <span class="math inline">\(K_{\Delta Q}\)</span> is the slope of the droop curve. Again, the reactive power measurement is filtered to avoid including high-frequency harmonics, applying a low-pass filter with a bandwidth <span class="math inline">\(\omega_{\Delta Q}\)</span>, and a time constant <span class="math inline">\(\tau_{\Delta Q} = \frac{1}{\omega_{\Delta Q}}\)</span>. The block diagram of the reactive power droop control is shown in the following figure:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ReactiveDroopGFM.svg" class="img-fluid figure-img"></p>
<figcaption>Reactive Power Droop Diagram</figcaption>
</figure>
</div>
<div class="figure-caption">
<p>Figure 3: Reactive Power Droop Diagram</p>
</div>
<p><strong>Virtual Synchronous Machine (VSM)</strong></p>
<p>Another alternative to the droop control is the Virtual Synchronous Machine (VSM) control <a href="#6">[6]</a>, which is a control strategy that emulates the electromechanical behavior of a synchronous machine. This type of control emulates the swing equation of a synchronous machine:</p>
<p><span class="math display">\[
J \frac{d\omega}{dt} = P_r^* - P_e - P_d
\]</span></p>
<p>where <span class="math inline">\(J\)</span> is the inertia of the machine, <span class="math inline">\(\omega\)</span> is the angular frequency of the machine, <span class="math inline">\(P_r^*\)</span> is the virtual input power (which emulates the mechanical power), and <span class="math inline">\(P_e\)</span> is the electrical power and <span class="math inline">\(P_d\)</span> is the damping power of the virtual machine. The input power is calculated as the sum of the setpoint power and the droop power deviation <span class="math inline">\(P_r^* = P^* + k_{\omega}(\omega^*-\omega)\)</span>, the electrical power is the measure of the active power, and the damping power is obtained from simulating the damping using the relationship <span class="math inline">\(P_d = k_d (\omega - \omega_g)\)</span>, where <span class="math inline">\(\omega_g\)</span> is the measure of the grid frequency, that has to be measured using a PLL, which can be the same as in the <a href="../EMTGridFollowingVSC/">Grid Following model</a>. The full control diagram is shown in the following figure:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="VSM_GFM.svg" class="img-fluid figure-img"></p>
<figcaption>VSM Diagram</figcaption>
</figure>
</div>
<div class="figure-caption">
<p>Figure 4: VSM Synchronization Loop Diagram</p>
</div>
<p>As it can be seen, the leftmost part of the control corresponds to the droop control part of the synchronization loop, meaning that the droop control method can be related to a particular case of the VSM method. The reactive power control will be the same as in the droop control method.</p>
<p>Considering the <em>qd0</em> reference frame in which <span class="math inline">\(v^{d*} = 0\)</span>, the voltage setpoint <span class="math inline">\(v^{q*}\)</span> is equal to the module obtained from the reactive power droop control. The following section shows the voltage control droops applied to these references.</p>
</section>
<section id="voltage-control" class="level3">
<h3 class="anchored" data-anchor-id="voltage-control">Voltage control</h3>
<p>The voltage control is used to determine the current setpoints that will be used to control the converter. The tuning of this control has been done using the Internal Model Control method (IMC) <a href="#8">[8]</a>, which provides PI controllers tuned in terms of the machine parameters (in this case <span class="math inline">\(C_f\)</span>) with the desired response. Using Kirchhoff current law and neglecting the parasite resistance <span class="math inline">\(R_{cap}\)</span> of the capacitors, the differential equations that model the relationship between voltage and currents in the Grid Forming VSC are the following:</p>
<p><span class="math display">\[
i^{qd*}_c - i^{qd}_g = \begin{bmatrix} 0 &amp; -\omega C_f \\ \omega{C_f} &amp; 0 \end{bmatrix} v^{qd}_f + \frac{d}{dt} \begin{bmatrix} v^d_f \\ v^q_f\end{bmatrix}
\]</span></p>
<p>where <span class="math inline">\(C_f\)</span> are the capacitance of the filter, <span class="math inline">\(i^{qd*}_c\)</span> are the current setpoints at the converter side, <span class="math inline">\(i^{qd}_g\)</span> are the current measurements at the grid side after the capacitor, and <span class="math inline">\(v^{qd}_f\)</span> are the voltages measured at the filter. A change of variables that considers the coupling can be used to simplify the expressions, as well as using the Laplace transformation:</p>
<p><span class="math display">\[
\begin{bmatrix} \hat{i^d} \\ \hat{i^q} \end{bmatrix} = \begin{bmatrix} i^d_c - i^d_g + \omega C_f v^q_f \\ i^q_c - i^q_g - \omega C_f v^d_f \end{bmatrix} = \begin{bmatrix} sC_f v^d_f \\ sC_f v^q_f\end{bmatrix}
\]</span></p>
<p>With the following block diagram representing the above relationship, and including a PI controller, forming the open-loop block diagram:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="VoltageControlGFM.svg" class="img-fluid figure-img"></p>
<figcaption>Voltage Control Diagram</figcaption>
</figure>
</div>
<div class="figure-caption">
<p>Figure 5: Voltage Control Diagram</p>
</div>
<p>From the previous section, the setpoints are decided to be <span class="math inline">\(v^{q*}_f = V\)</span> and <span class="math inline">\(v^{d*}_f = 0\)</span>. To close the loop, the following plant is proposed which relates the decoupling current variables with the voltages:</p>
<p><span class="math display">\[
\begin{align}
\frac{v^d_f}{\hat{i^d}} &amp;= \frac{1}{sC_f} \\
\frac{v^q_f}{\hat{i^q}} &amp;= \frac{1}{sC_f}
\end{align}
\]</span></p>
<p>with the following block diagram:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="VoltageErrorGFM.svg" class="img-fluid figure-img"></p>
<figcaption>Voltage Closed-Loop Diagram</figcaption>
</figure>
</div>
<div class="figure-caption">
<p>Figure 6: Voltage Closed-Loop Diagram</p>
</div>
<p>The closed-loop transfer function of the voltage control can be obtained by adding a PI controller to the open-loop transfer function. The PI controller is designed to have a second-order response, with the following transfer function:</p>
<p><span class="math display">\[
\frac{v^{qd}_f}{v^{qd*}} = \frac{sK^{vcl}_p + K^{vcl}_i}{s^2 C_f +sK^{vcl}_p + K^{vcl}_i}
\]</span></p>
<p>The tuning of the control parameters will be so that the denominator adopts the form <span class="math inline">\(s^2 + 2\xi \omega_n C_f s + \omega_n^2\)</span>. With this, the values are:</p>
<p><span class="math display">\[
\begin{align}
K^{vcl}_p &amp;= 2\xi \omega_n C_f \\
K^{vcl}_i &amp;= \omega_n^2 C_f
\end{align}
\]</span></p>
<p>with a damping factor <span class="math inline">\(\xi\)</span> often between 0.5 and 1 (<span class="math inline">\(\frac{\sqrt{2}}{2}\)</span> is a common value) and a natural frequency <span class="math inline">\(\omega_n\)</span>.</p>
<p>Over these current setpoints, a current control equivalent to the one from the grid-following can be applied.</p>
</section>
<section id="current-control" class="level3">
<h3 class="anchored" data-anchor-id="current-control">Current control</h3>
<p>The current control is used to determine the converter voltage that has to be applied in order to maintain the current at the setpoint. The tuning uses again the Internal Model Control method (IMC), described in <a href="#8">[8]</a> as in the Grid Following model. The control is based on the electric relationship between the variables:</p>
<p><span class="math display">\[
v_c^{abc*} - v_{f}^{abc} = R_f i_c^{abc} + L_f \frac{d}{dt} i_c^{abc}
\]</span></p>
<p>which can be transformed into the <em>qd</em> frame to obtain the following equation:</p>
<p><span class="math display">\[
v_c^{qd*} - v_{f}^{qd} =\begin{bmatrix} R_f &amp; L_f \omega\\ -L_f \omega &amp; R_f \end{bmatrix} i_c^{qd} + L_f \frac{d}{dt} i_c^{qd}
\]</span></p>
<p>where <span class="math inline">\(\omega\)</span> is the angular frequency of the grid obtained in the synchronization loop, and <span class="math inline">\(v^{d*} = 0\)</span>. The block diagram associated to this system is the following:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="CurrentControlGFM.svg" class="img-fluid figure-img"></p>
<figcaption>Current Control Diagram</figcaption>
</figure>
</div>
<div class="figure-caption">
<p>Figure 7: Current Control Diagram</p>
</div>
<p>As it can be seen, there is a coupling between the <em>q</em> and <em>d</em> components. This can be dealt by the controller by designing a two dimension controller, or by decoupling the components and independently controlling each component. The later approach is the chosen in this model, using the following expression:</p>
<p><span class="math display">\[
\begin{bmatrix} \hat{v}^{q} \\ \hat{v}^{d} \end{bmatrix} = \begin{bmatrix} v^{q*} - v_f^{q} + L_f \omega i^d_c  \\ v^{d*} - L_f \omega i^q_c \end{bmatrix}
\]</span></p>
<p>where <span class="math inline">\(\hat{v}^{q}\)</span> and <span class="math inline">\(\hat{v}^{d}\)</span> are the controller output voltages. The equations are now decoupled using the expression:</p>
<p><span class="math display">\[
\begin{bmatrix} \hat{v}^{q} \\ v^{d} \end{bmatrix} = \begin{bmatrix} R_f &amp; 0\\ 0 &amp; R_f \end{bmatrix} \begin{bmatrix} i^q_c \\ i^d_c \end{bmatrix} + L_f \frac{d}{dt} \begin{bmatrix}  i^q_c \\ i^d_c \end{bmatrix}
\]</span></p>
<p>Applying the Laplace transformation and reordering, the following relation holds:</p>
<p><span class="math display">\[
\frac{i^{qd*}_c(s)}{\hat{v}^{qd}(s)} = \frac{1}{R_f + sL_f}
\]</span></p>
<p>The closed-loop transfer function, considering <span class="math inline">\(G_c = K^{icl}_p + \frac{K^{icl}_i}{s}\)</span> is:</p>
<p><span class="math display">\[
\frac{i^{qd}_s(s)}{i^{qd*}_s(s)} = \frac{G_c(s)}{(L_f + L_c)s + (R_f + R_c) + G_c(s)}
\]</span></p>
<p>where <span class="math inline">\(i^{qd*}_c(s)\)</span> is the reference current for <em>q</em> or <em>d</em> axis at the converter side, and <span class="math inline">\(i^{qd}_c(s)\)</span> is the measured current. The controller gains can be selected as <span class="math inline">\(K^{icl}_p = \frac{L_f}{\tau_c}\)</span> and <span class="math inline">\(K^{icl}_i = \frac{R_f}{\tau_c}\)</span>, where <span class="math inline">\(\tau_c\)</span> is the time constant of the current loop, such that the complete closed-loop transfer function is represented as the following first-order response:</p>
<p><span class="math display">\[
\frac{i^{qd}_c(s)}{i^{qd*}_c(s)} = \frac{1}{\tau_c s + 1}
\]</span></p>
<p>The resulting PI controller is the following:</p>
<p><span class="math display">\[
G_{c}(s) = K_p + \frac{K_i}{s} = \frac{L_f}{\tau_c} + \frac{R_f}{\tau_c s}
\]</span></p>
</section>
<section id="limitations-of-current" class="level3">
<h3 class="anchored" data-anchor-id="limitations-of-current">Limitations of current</h3>
<p>The technical constraints of the VSC can be included in the controls using saturation blocks. In section 3.5 of the <a href="../EMTGridFollowingVSC/">EMT Grid Following Model</a>, there is an example of implementation of the anti-windup controls for the transformer.</p>
</section>
<section id="modulation" class="level3">
<h3 class="anchored" data-anchor-id="modulation">Modulation</h3>
<p>As in the <a href="../EMTGridFollowingVSC/">EMT Grid Following Model</a>, the converter voltage setpoint obtained can be considered directly the converter voltage, in what is called an Averaged Model, since it does not consider the switching process. However, a more complete EMT simulation will model the modulation performed to obtain the sinusoidal voltage from the DC source. The details can be consulted in Section 3.6 of the said model.</p>
</section>
</section>
<section id="parameter-tuning" class="level2">
<h2 class="anchored" data-anchor-id="parameter-tuning">Parameter tuning</h2>
<p>The following table shows possible values for the parameters of the controllers using the tuning proposed:</p>
<p><strong>Static data for the lines</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 40%">
<col style="width: 18%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Line/Cable</th>
<th>Nominal Voltage (kV)</th>
<th><span class="math inline">\(R\)</span> (<span class="math inline">\(\Omega\)</span>)</th>
<th><span class="math inline">\(L\)</span> (<span class="math inline">\(H\)</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Converter - grid filter (grid connection)</td>
<td><span class="math inline">\(2.45\)</span> kV</td>
<td><span class="math inline">\(0.0326\)</span></td>
<td><span class="math inline">\(0.001038\)</span></td>
</tr>
<tr class="even">
<td>Converter - capacitor (GFM)</td>
<td><span class="math inline">\(2.45\)</span> kV</td>
<td><span class="math inline">\(0.0048913\)</span></td>
<td><span class="math inline">\(0.00031139\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Control parameters</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
<th>Units</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(C\)</span></td>
<td><span class="math inline">\(1.63 \cdot 10^{-4}\)</span></td>
<td><span class="math inline">\(F\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\omega_n^{PLL}\)</span></td>
<td><span class="math inline">\(2\pi 1000\)</span></td>
<td><span class="math inline">\(rad/s\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\zeta^{PLL}\)</span></td>
<td><span class="math inline">\(0.707\)</span></td>
<td><span class="math inline">\(-\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(K^{PLL}_p\)</span></td>
<td><span class="math inline">\(3.55\)</span></td>
<td><span class="math inline">\(-\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(K^{PLL}_i\)</span></td>
<td><span class="math inline">\(1.58 \cdot 10^4\)</span></td>
<td><span class="math inline">\(-\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\tau^{PLL}\)</span></td>
<td><span class="math inline">\(0.225\)</span></td>
<td><span class="math inline">\(ms\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\tau^c\)</span></td>
<td><span class="math inline">\(1\)</span></td>
<td><span class="math inline">\(ms\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(K^{icl}_p\)</span></td>
<td><span class="math inline">\(0.13494\)</span></td>
<td><span class="math inline">\(-\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(K^{icl}_i\)</span></td>
<td><span class="math inline">\(100\)</span></td>
<td><span class="math inline">\(-\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(K^{vcl}_p\)</span></td>
<td><span class="math inline">\(5\)</span></td>
<td><span class="math inline">\(-\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(K^{vcl}_i\)</span></td>
<td><span class="math inline">\(500\)</span></td>
<td><span class="math inline">\(-\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(K^{Droop}_p\)</span></td>
<td><span class="math inline">\(2\pi 50\)</span></td>
<td><span class="math inline">\(-\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="open-source-implementations" class="level2">
<h2 class="anchored" data-anchor-id="open-source-implementations">Open source implementations</h2>
<p>This model has been successfully implemented in :</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Software</th>
<th>URL</th>
<th>Language</th>
<th>Open-Source License</th>
<th>Last consulted date</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>PSTess</td>
<td><a href="https://github.com/sandialabs/snl-pstess/blob/master/pstess/gfma.m">Link</a></td>
<td>MATLAB</td>
<td>Copyright 2021 National Technology &amp; Engineering Solutions of Sandia, LLC (NTESS)</td>
<td>09/07/2024</td>
<td>Droop control version, equivalent to REGFM_A1 from WECC accepted dynamic models</td>
</tr>
</tbody>
</table>
</section>
<section id="table-of-references" class="level2">
<h2 class="anchored" data-anchor-id="table-of-references">Table of references</h2>
<p><a id="1">[1]</a> Lacerda, V. A.; Prieto-Araujo, E.; Cheah, M.; Gomis-Bellmunt, O. Phasor and EMT models of grid-following and grid-forming converters for short-circuit simulations., October 2023, vol.&nbsp;223, nm. 109662. DOI: <a href="https://doi.org/10.1016/j.epsr.2023.109662">10.1016/j.epsr.2023.109662</a></p>
<p><a id="2">[2]</a> Akagi, H., Watanabe, E., Aredes, M.: Instantaneous power theory and Applications to power conditioning. Wiley, Chichester (2007)</p>
<p><a id="3">[3]</a> Clarke, E., Circuit Analysis Of A-c Power System Vol I, John Wiley and Sons, 1941</p>
<p><a id="4">[4]</a> Park, R. H., Two-reaction theory of synchronous machines generalized method of analysis-part I, AIEE Transactions, Vol. 48, Issue 3, July 1929. DOI: <a href="https://doi.org/10.1109/T-AIEE.1929.5055275">10.1109/T-AIEE.1929.5055275</a></p>
<p><a id="5">[5]</a> Rathnayake, D. B., et al.&nbsp;Grid forming inverter modeling, control, and applications. IEEE Access, 9, 114781-114807 (2021).</p>
<p><a id="6">[6]</a> DArco, S.; Suul, J.A.; Fosso, O.B. A Virtual Synchronous Machine implementation for distributed control of power converters in SmartGrids, Electric Power Systems Research, Volume 122, 2015, Pages 180-197, DOI: <a href="https://doi.org/10.1016/j.epsr.2015.01.001">10.1016/j.epsr.2015.01.001</a></p>
<p><a id="7">[7]</a> S. DArco and J. A. Suul, Equivalence of Virtual Synchronous Machines and Frequency-Droops for Converter-Based MicroGrids, in IEEE Transactions on Smart Grid, vol.&nbsp;5, no. 1, pp.&nbsp;394-395, Jan.&nbsp;2014, DOI: <a href="https://doi.org/10.1109/TSG.2013.2288000">10.1109/TSG.2013.2288000</a></p>
<p><a id="8">[8]</a> Harnefors, L.; Nee, H. P. Model-Based Current Control of AC Machines Using the Internal Model Control Method. IEEE Transactions on Industrial Applications, Vol. 34, No.&nbsp;1, January/February 1998, DOI: <a href="https://doi.org/10.1109/28.658735">10.1109/28.658735</a></p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/CRESYM\.github\.io\/Colib_Quarto\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright  2023-2025 Authors of Collaborative Open-Source Dynamic Simulation Library. Content licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY-4.0</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../../../about/index.html">
<p>About</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../../../contact.html">
<p>Contact</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://cresym.eu/privacy-policy/">
<p>Privacy Policy</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../../../about/terms.html">
<p>Terms of Reference</p>
</a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/CRESYM/Colib_Quarto.github.io">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>